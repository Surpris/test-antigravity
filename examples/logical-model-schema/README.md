# 論理モデルスキーマ・テンプレート (Logical Model Schema)

このディレクトリには、論理データモデルを記述するための中間表現（Intermediate Representation）の定義と、それを作成するためのガイドラインが含まれています。

## 概要

リレーショナルデータベース（RDB）やグラフデータベースなど、特定の物理実装に依存しない「論理的なデータ構造」をYAML形式で定義するためのリソースを提供します。これにより、設計のポータビリティを高め、AIを活用したデータモデリングの自動化を支援します。

## ファイル構成と役割

### 1. `logical_model_schema.json`

論理データモデルの構造を定義する **JSON Schema** です。

- **用途**: 記述されたYAMLファイルが、定義された構造（エンティティ、属性、リレーションシップの形式など）に従っているかを検証するために使用します。
- **主な定義内容**:
  - `entities`: モデル内のエンティティ定義
  - `attributes`: データ型（String, Integer, Enum等）、主キー設定、必須チェック
  - `relationships`: ターゲットエンティティと多重度（1:1, 1:N等）

### 2. `prompt_generate_logical_model.md`

論理モデルを生成・記述するための **仕様書兼AIプロンプト** です。

- **用途**: AI（LLM）に対して「このフォーマットでデータモデルを出力してください」と指示するためのプロンプトとして、あるいは人間が手動でモデルを記述する際の規約として使用します。
- **内容**:
  - 命名規則（PascalCase/snake_case）
  - 各フィールドの詳細な記述方法
  - 具体的な記述例（ContributorとDatasetの関係など）

### 3. `logical_model_schema_separated.json`

論理データモデルを**複数のファイル（モジュール）に分割して定義**する場合の検証用 JSON Schema です。

- **用途**: 大規模なモデルなどで、エンティティ定義をファイルごとに分割して管理したい場合に使用します。
- **特徴**: `entities` だけを持つ断片的なYAMLファイルも許容するスキーマ定義になっています。

### 4. `prompt_generate_logical_model_separated.md`

分割モデルを生成・記述するための**仕様書兼AIプロンプト**です。

- **内容**:
  - **Pattern A (Master Definition)**: モデル全体のメタデータ定義
  - **Pattern B (Entity Fragment)**: 個別のエンティティ定義

## サンプル実装

このディレクトリには、論理モデルを活用するためのサンプルプロジェクトが含まれています。

### `with_gemini_app`

論理モデルの記述、検証（Validation）、ドキュメント生成などのワークフローを実践するためのサンプルです。

- `ajv` によるスキーマバリデーション
- `spectral` によるリンター設定
- TypeScript によるモデル操作スクリプト

### `with_antigravity`

論理モデル (YAML) から TypeScript のインターフェース定義を自動生成するジェネレータの実装例です。

- `generate-data-model-typescript.ts`: YAMLを読み込み、型安全なTypeScriptコードを出力します。

## 使い方の流れ

### ステップ1: モデルの作成

`prompt_generate_logical_model.md` の内容をAIのコンテキスト（System Promptなど）として読み込ませ、要件に基づいた論理データモデルをYAML形式で生成させます。

### ステップ2: 構造の検証

生成されたYAMLファイルをJSONに変換し、`logical_model_schema.json` を用いて、スキーマに適合しているかバリデーションを行います。

### ステップ3: 物理設計への展開

このディレクトリで作成された論理モデルを元に、物理データベース（PostgreSQLのDDLやNeo4jのスキーマ等）の生成コードを作成する際の中間形式として活用します。

---

## 規約

- **エンティティ名**: `PascalCase` で記述します。
- **属性名・リレーション名**: `snake_case` で記述します。
- **多重度の指定**: `1:1`, `1:N`, `0:1`, `0:N`, `N:M` のいずれかを使用します。
